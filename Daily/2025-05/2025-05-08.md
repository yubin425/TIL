
# 🐞 버그/에러 개요

CloudFront에서 기본 루트 오브젝트(`index.html`) 설정으로 인해 SSR 서버의 루트 요청(`/`)이 EC2로 전달되지 않고 404 오류가 발생함

---

# 📝 상황 설명

### 📄 에러 대상

* AWS CloudFront 배포 설정 (`Default Root Object`)
* EC2 + Nginx + Next.js SSR 서비스 구조

---

### 🕵🏻‍♀️ 에러 상황

* 배포 후 `https://kakaotech.com/` 루트 경로 접속 시 **CloudFront가 즉시 404 반환**
* `tail -f /var/log/nginx/access.log` 상에서도 루트 요청이 도달하지 않음 → **CloudFront가 오리진까지 요청을 전달하지 않음**
* TTL을 0으로 설정했음에도 효과 없음
* `curl -I http://localhost:3000/` 결과로 Next.js가 `/ → /chatbot`으로 `307 Redirect`를 정상 응답 중이었으나 **CloudFront에서 무시됨**
* 원인은 **CloudFront 설정의 기본 루트 오브젝트가 `index.html`로 지정되어 있었기 때문**

---

### ✅ Resolve TODO

* [x] CloudFront 배포 설정에서 Default Root Object 필드 비우기
* [x] 변경사항 저장 및 배포 완료 대기
* [x] 브라우저 및 curl로 `/` 요청 테스트하여 EC2 → Nginx → Node.js 경로가 정상 동작하는지 확인

---

### 📚 Remarks

* CloudFront는 기본적으로 정적 웹사이트(S3) 중심의 동작 모델을 따르므로, SSR 서버 구조에서는 **기본 루트 오브젝트 설정이 오히려 문제를 일으킬 수 있음**
* 정적 호스팅과 SSR 배포 시 요구 설정이 다르므로, **CloudFront 설정을 프로젝트 성격에 따라 구분 적용할 것**
* 향후 배포 자동화 시 CloudFront 설정에 대한 검증 항목(예: 오리진 경로, 기본 루트 오브젝트 비어 있는지 등)도 포함 예정


